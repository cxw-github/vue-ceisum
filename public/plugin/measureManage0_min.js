(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{183:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(17)),a=c(i(1)),s=c(i(2)),l=c(i(18)),o=c(i(19)),r=c(i(3)),u=c(i(85));function c(e){return e&&e.__esModule?e:{default:e}}var d=window.Cesium,p={gis:null,lineHandle:null,areaHandle:null,reset:function(){this.lineHandle=this.lineHandle&&this.lineHandle.destroy(),this.areaHandle=this.areaHandle&&this.areaHandle.destroy()},destroy:function(e,t){var i=new d.ScreenSpaceEventHandler(this.gis.scene.canvas);this.lineHandle=e&&this.lineHandle&&this.lineHandle.destroy()||i,this.areaHandle=t&&this.areaHandle&&this.areaHandle.destroy()||i}},h={instant:null,points:[],getDistance:function(){return 2!==this.points.length?"":(r.default.getDistanceFrom2Points(this.points[0],this.points[1])/1e3).toFixed(3)+" km"},labelTips:function(e){var t=this;return new d.Entity({position:new d.CallbackProperty(function(){return r.default.getCenterCartesian(t.points)},!1),label:{text:new d.CallbackProperty(function(i){return e.call(t,i)},!1),font:"28px sans-serif",fillColor:d.Color.fromCssColorString("#00CED1"),pixelOffset:new d.Cartesian2(0,-10),scale:.6}})}},f=function(e){function t(e){(0,a.default)(this,t);var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.gis=e,p.gis=e,i.tips=null,i.instant=null,i.colletion=new d.EntityCollection,i.graphics=i.gis.graphics,i.defalutValue=function(e,t){return void 0!==e?e:t},i.defalutColorValue=function(e,t){return void 0!==e?d.Color.fromCssColorString(e):d.Color.fromCssColorString(t)},i}return(0,o.default)(t,e),(0,s.default)(t,[{key:"initial",value:function(){this.viewer=this.gis.viewer,this.scene=this.gis.scene}},{key:"stopPropagation",value:function(e){this.completeStatus(),(e=window.event||e)&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)}},{key:"completeStatus",value:function(){this.gis.isToolWight=!0,this.instant&&this.viewer.entities.remove(this.instant),this.tips&&this.viewer.entities.remove(this.tips),h.instant&&this.viewer.entities.remove(h.instant),h.points=[],delete this.instant,delete this.tips,delete h.instant}},{key:"lineMeasureTool",value:function(e){this.stopPropagation(e),p.destroy(!1,!0);var t=!1,i=!0;p.lineHandle.setInputAction(function(e){t=!0,this.gis.disableDefaultEventHandlers(!1,!1,!0,!1,!1);var i=this.viewer.camera.pickEllipsoid(e.position,this.scene.globe.ellipsoid);i&&(h.points.push(i),this.tips=this.tips||this.viewer.entities.add(h.labelTips(h.getDistance)))}.bind(this),d.ScreenSpaceEventType.LEFT_DOWN),p.lineHandle.setInputAction(function(e){if(t){var n=h.points.length,a=this.viewer.camera.pickEllipsoid(e.endPosition,this.scene.globe.ellipsoid);a&&(n>1&&h.points.splice(1,n),h.points.push(a),i&&(this.instant=this.addLineCallback(function(){return r.default.getCenterCartesian(h.points)},function(){return h.points},null,null,"#FFD700"),this.viewer.entities.add(this.instant),i=!i))}}.bind(this),d.ScreenSpaceEventType.MOUSE_MOVE),p.lineHandle.setInputAction(function(e){t=!1,i=!0;var n=this.viewer.camera.pickEllipsoid(e.position,this.scene.globe.ellipsoid),a=h.points.length;if(n&&a&&(a>1&&h.points.splice(1,a),!h.points[0].equals(n)&&h.points.push(n)),2===h.points.length){var s=this.gis.addLine(d.createGuid(),h.points,h.getDistance(),"","#FFD700",.8,"",!0,2);s.label.fillColor=d.Color.fromCssColorString("#00CED1"),s.label.horizontalOrigin=d.HorizontalOrigin.CENTER,s.label.pixelOffset=new d.Cartesian2(0,-10),s.type=void 0,this.colletion.add(s)}this.viewer.entities.remove(this.instant),this.viewer.entities.remove(this.tips),h.points=[],delete this.tips,delete this.instant,this.gis.disableDefaultEventHandlers(!0,!0,!0,!0,!0)}.bind(this),d.ScreenSpaceEventType.LEFT_UP)}},{key:"areaMeasureTool",value:function(e){this.stopPropagation(e),p.destroy(!0,!1);var t=!1,i=!0,n=0;p.areaHandle.setInputAction(function(e){var a=this;t=!0;var s=this.viewer.camera.pickEllipsoid(e.position,this.scene.globe.ellipsoid);s&&(h.points.push(s),n++,this.tips=this.tips||this.viewer.entities.add(h.labelTips(function(){return h.points.length<3?"":(a.graphics.getAreaSizeFromPoints(h.points)/1e6).toFixed(3)+"km²"})),n<2?(h.instant=this.addLineCallback(function(){return r.default.getCenterCartesian(h.points)},function(){return h.points},null,null,"#FFD700"),this.viewer.entities.add(h.instant)):i&&(this.instant=this.addAreaCallback(function(){return r.default.getCenterCartesian(h.points)},function(){return h.points},null,null,"#FFD700",.7),this.viewer.entities.add(this.instant),i=!1))}.bind(this),d.ScreenSpaceEventType.LEFT_CLICK),p.areaHandle.setInputAction(function(e){if(t){var i=h.points.length,a=this.viewer.camera.pickEllipsoid(e.endPosition,this.scene.globe.ellipsoid);a&&(i>n&&h.points.splice(n,i),h.points.push(a),2===n&&h.instant&&(this.viewer.entities.remove(h.instant),delete h.instant))}}.bind(this),d.ScreenSpaceEventType.MOUSE_MOVE),p.areaHandle.setInputAction(function(e){t=!1,i=!0;var a=h.points.length;if(a>n&&h.points.splice(n,a),h.points.length>2){var s=this.graphics.getAreaSizeFromPoints(h.points)/1e6,l=this.gis.addPolygon(d.createGuid(),h.points,s.toFixed(3)+"km²","",!0,"#FFD700",.7,"",!0,2);l.type=void 0,l.label.horizontalOrigin=d.HorizontalOrigin.CENTER,this.colletion.add(l)}h.instant&&this.viewer.entities.remove(h.instant),this.viewer.entities.remove(this.instant),this.viewer.entities.remove(this.tips),h.points=[],n=0,delete h.instant,delete this.tips,delete this.instant}.bind(this),d.ScreenSpaceEventType.RIGHT_CLICK)}},{key:"stopMeasure",value:function(e){this.stopPropagation(e),p.reset(),this.gis.isToolWight=!1}},{key:"removeMeasure",value:function(e){var t=this;this.stopPropagation(e),this.colletion.values.forEach(function(e){return t.gis.removeOverlayById(e.id)})}}]),t}(u.default);t.default=f},188:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(17)),a=c(i(1)),s=c(i(2)),l=c(i(18)),o=c(i(19)),r=c(i(183)),u=c(i(3));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,a.default)(this,t);var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.gis=e,i.dom=null,i}return(0,o.default)(t,e),(0,s.default)(t,[{key:"init",value:function(){var e=this,t=void 0,i=void 0,n=void 0,a=this.gis.config.plugin.type,s=this.gis.pluginManage,l=u.default.createList({id:"Measure",title:"测量工具",className:"gis-nav-bar clearFix",listClassName:"gis-measure",parent:s.toolBar,onclick:function(l){o.dom.classList.toggle("active"),t=t||a.dateModule&&s.getPlugin("DateTime"),n=n||a.dragModule&&s.getPlugin("DragTool"),i=i||a.drawModule&&s.getPlugin("DrawTool"),t&&t.proto.close(),i&&i.proto.close(),n&&n.proto.close(),e.stopMeasure(l)}}),o=s.addPlugin({id:"MeasureTool",title:"测量工具",className:"gis-tool gis-measureTool",type:"tool",proto:this,parent:l});this.dom=o.dom,this.initial(),this.loadMeasureToolOperate(o.dom)}},{key:"loadMeasureToolOperate",value:function(e){u.default.createList({title:"线测量",className:"clearFix",listClassName:"gis-lineMeasure",parent:e,onclick:this.lineMeasureTool.bind(this)}),u.default.createList({title:"区域测量",listClassName:"gis-areaMeasure",parent:e,onclick:this.areaMeasureTool.bind(this)}),u.default.createList({title:"移除测量",listClassName:"gis-removeMeasure",parent:e,onclick:this.removeMeasure.bind(this)}),u.default.createList({title:"停止测量",listClassName:"gis-stopMeasure",parent:e,onclick:this.stopMeasure.bind(this)})}},{key:"close",value:function(){this.dom.classList.remove("active"),this.stopMeasure()}},{key:"enable",value:function(e){e=Boolean(e),this.dom.parentNode.style.display=e?"block":"none"}}]),t}(r.default);t.default=d},85:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(1)),a=s(i(2));function s(e){return e&&e.__esModule?e:{default:e}}var l=window.Cesium,o=function(){function e(){(0,n.default)(this,e),this.defaultColorValue=function(e,t){return void 0!==e?l.Color.fromCssColorString(e):l.Color.fromCssColorString(t)},this.defaultValue=function(e,t){return void 0!==e?e:t}}return(0,a.default)(e,[{key:"addPointCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments[2],n=arguments[3],a=(arguments[4],arguments[5]),s=arguments[6],o=this.gis.config.site.relative;return s=s&&o+"/images/flag/"+s+".png"||null,new l.Entity({name:t,description:i||"",label:{text:t,font:"28px sans-serif",fillColor:l.Color.DARKTURQUOISE,horizontalOrigin:l.HorizontalOrigin.LEFT,scale:.6,show:this.defaultValue(a,!0),translucencyByDistance:new l.NearFarScalar(295e3,2,3e5,2),scaleByDistance:new l.NearFarScalar(3e6,1.1,525e6,.1)},billboard:{image:s,scale:.5,show:s&&!0},position:new l.CallbackProperty(e,!1),point:{pixelSize:5,color:this.defaultColorValue(n,"#F0F")}})}},{key:"addLineCallback",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments[3],a=arguments[4],s=arguments[5],o=arguments[6],r=this.gis.config.site.relative;return o=o&&r+"/images/flag/"+o+".png"||null,new l.Entity({name:i,description:n||"",label:{text:i,font:"28px sans-serif",fillColor:l.Color.DARKTURQUOISE,horizontalOrigin:l.HorizontalOrigin.LEFT,scale:.6,show:s&&!0,translucencyByDistance:new l.NearFarScalar(295e3,2,3e5,2),scaleByDistance:new l.NearFarScalar(3e6,1.1,525e6,.1)},billboard:{image:o,scale:.5,show:o&&!0},position:new l.CallbackProperty(e,!1),polyline:{positions:new l.CallbackProperty(t,!1),width:2,material:this.defaultColorValue(a,"#FFD700")}})}},{key:"addRectangleCallback",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments[3],a=arguments[4],s=arguments[5],o=arguments[6],r=arguments[7],u=arguments[8],c=this.gis.config.site.relative;return r=r&&c+"/images/flag/"+r+".png"||null,s=s||(0===s?s:.3),u=this.defaultValue(u,!0),new l.Entity({name:i,description:n||"",position:new l.CallbackProperty(e,!1),label:{text:i,font:"28px sans-serif",fillColor:l.Color.DARKTURQUOISE,horizontalOrigin:l.HorizontalOrigin.LEFT,scale:.6,show:o&&!0,translucencyByDistance:new l.NearFarScalar(295e3,2,3e5,2),scaleByDistance:new l.NearFarScalar(3e6,1.1,525e6,.1)},billboard:{image:r,scale:.5,show:r&&!0},rectangle:{coordinates:new l.CallbackProperty(t,!1),fill:u,material:this.defaultColorValue(a,"#0000FF").withAlpha(s),height:-2e4,outline:!0,outlineColor:this.defaultColorValue(a,"#0000FF").withAlpha(s)}})}},{key:"addAreaCallback",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments[3],a=arguments[4],s=arguments[5],o=arguments[6],r=arguments[7],u=this.gis.config.site.relative;return r=r&&u+"/images/flag/"+r+".png"||null,s=s||(0===s?s:.3),new l.Entity({name:i,description:n||"",label:{text:i,font:"28px sans-serif",fillColor:l.Color.DARKTURQUOISE,horizontalOrigin:l.HorizontalOrigin.LEFT,scale:.6,show:o&&!0,translucencyByDistance:new l.NearFarScalar(295e3,2,3e5,2),scaleByDistance:new l.NearFarScalar(3e6,1.1,525e6,.1)},billboard:{image:r,scale:.5,show:r&&!0},position:new l.CallbackProperty(e,!1),polygon:{hierarchy:new l.CallbackProperty(t,!1),fill:!0,material:this.defaultColorValue(a,"#0000FF").withAlpha(s),height:0,outline:!0,outlineWidth:2,outlineColor:this.defaultColorValue(a,"#0000FF").withAlpha(s)}})}},{key:"addMoveTargetPathCallback",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments[4];return new l.Entity({name:i,description:n,label:{text:i,font:"28px sans-serif",fillColor:l.Color.DARKTURQUOISE,horizontalOrigin:l.HorizontalOrigin.LEFT,scale:.6,show:a&&!0,translucencyByDistance:new l.NearFarScalar(295e3,2,3e5,2),scaleByDistance:new l.NearFarScalar(3e6,1.1,525e6,.1)},position:new l.CallbackProperty(e,!1),polyline:{positions:new l.CallbackProperty(t,!1),width:2,material:new l.PolylineOutlineMaterialProperty({color:l.Color.CHARTREUSE,outlineColor:l.Color.BROWN,outlineWidth:2,width:2})}})}}]),e}();t.default=o}}]);