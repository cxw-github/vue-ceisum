(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{185:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=r(i(130)),n=r(i(1)),a=r(i(2)),l=r(i(3));function r(t){return t&&t.__esModule?t:{default:t}}var h=function(){function t(){(0,n.default)(this,t),this.parentDiv=null,this.timePointer=null,this.needle=null,this.width=null,this.timeline=null,this.timelineBar=null,this.timeWidth=null,this.viewer=null,this.clock=null,this.currentTime=null,this.startTime=null,this.stopTime=null,this.multiplier=null,this.positionInfo=null,this.stripe=[],this.axisStartTime=null,this.axisStopTime=null,this.axisStartLeft=null,this.axisStopLeft=null,this.eventListener=null}return(0,a.default)(t,[{key:"initial",value:function(){this.clock=this.gis.clock,this.currentTime=this.currentTime||this.clock.currentTime,this.multiplier=this.multiplier||this.clock.multiplier,this.startTime=this.startTime||this.clock.startTime,this.stopTime=this.stopTime||this.clock.stopTime,this.timeline=document.querySelector(".cesium-viewer-timelineContainer"),this.needle=document.querySelector(".cesium-timeline-needle"),this.timelineBar=document.querySelector(".cesium-timeline-bar"),this.clockCtrl=this.gis.pluginManage.getPlugin("ClockCtrl"),this.positionInfo=document.querySelector(".gis-positionInfo")}},{key:"refreshPluginPosition",value:function(){var t=this.parentDiv.parentNode.offsetHeight+this.timeline.offsetHeight;this.positionInfo.style.bottom=t+10+"px",this.clockCtrl&&(this.clockCtrl.dom.style.bottom=t+"px",this.positionInfo.style.right=this.clockCtrl.dom.offsetWidth+30+"px")}},{key:"initElementAndTimelineTic",value:function(){this.timeline.style.bottom=this.parentDiv.parentNode.offsetHeight+"px",this.refreshPluginPosition(),this.width=this.timelineBar.offsetWidth,this.parentDiv.parentNode.style.width=this.width+"px",this.timePointer&&(this.timePointer.style.left=this.needle?this.needle.offsetLeft+1+"px":0);var t=(0,s.default)(document.getElementsByClassName("cesium-timeline-ticLabel")),e=(0,s.default)(document.getElementsByClassName("cesium-timeline-ticMain")),i=t.length;i===e.length&&(this.axisStartTime=l.default.getDateForStringDate(t[0].innerHTML).getTime(),this.axisStopTime=l.default.getDateForStringDate(t[i-1].innerHTML).getTime(),this.axisStartLeft=e[0].offsetLeft,this.axisStopLeft=e[i-1].offsetLeft)}},{key:"initTargetSampleStripe",value:function(t){if(this.axisStartTime&&this.axisStopTime){var e=new Date(parseInt(t.getAttribute("start"))),i=new Date(parseInt(t.getAttribute("stop")));if(e<=this.axisStartTime&&i>=this.axisStopTime)t.style.left=0,t.style.right=0;else{this.timeWidth=(this.axisStopLeft-this.axisStartLeft)/(this.axisStopTime-this.axisStartTime);var s=this.axisStartLeft+this.timeWidth*(e-this.axisStartTime),n=this.axisStartLeft+this.timeWidth*(i-this.axisStartTime);n-s<1&&(n=s+1),t.style.left=s+1+"px",t.style.right=this.width-n-1+"px"}}}},{key:"initSampleTargetStripe",value:function(){this.stripe.length&&this.stripe.forEach(this.initTargetSampleStripe,this)}},{key:"initEventListener",value:function(){!this.timeline&&this.eventListener||(this.clockCtrl&&this.clockCtrl.addClassName("gis-offsetByGanttChart"),this.gis.addClockEvent(function t(){this.eventListener=t,this.initElementAndTimelineTic(),this.initSampleTargetStripe()},this))}},{key:"removeEventListener",value:function(){this.clockCtrl&&this.clockCtrl.removeClassName("gis-offsetByGanttChart"),this.gis.removeClockEvent(this.eventListener,this),this.eventListener=null,this.positionInfo.style.right="30px",this.positionInfo.style.bottom="40px"}}]),t}();e.default=h},194:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o(i(17)),n=o(i(1)),a=o(i(2)),l=o(i(18)),r=o(i(19)),h=o(i(3));function o(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(t){(0,n.default)(this,e);var i=(0,l.default)(this,(e.__proto__||(0,s.default)(e)).call(this));return i.gis=t,i}return(0,r.default)(e,t),(0,a.default)(e,[{key:"init",value:function(){var t=this.gis.pluginManage.addPlugin({id:"GanttChart",title:"甘特图",className:"gis-ganttChart",type:"chart",proto:this});return this.parentDiv=t.dom,t.dom.oncontextmenu=function(t){2===(t=t||window.event).button&&t.preventDefault()},this.initFrame(t.dom),this.initial(),this}},{key:"initFrame",value:function(t){var e=h.default.createDiv({className:"gis-ganttChartContainer"});return e.appendChild(t),this.gis.getManager().container.appendChild(e),e}},{key:"createPointer",value:function(){var t=document.createElement("time");return t.className="gis-timePointer",this.parentDiv.appendChild(t),t}},{key:"resetTargetTask",value:function(){this.isRunning(!1),this.parentDiv.innerHTML="",this.timePointer=null,this.stripe=[]}},{key:"initTargetTask",value:function(t){!this.eventListener&&this.isRunning(!0),this.timePointer||(this.timePointer=this.createPointer());var e=document.createElement("figure");e.id=t.id,e.className="gis-targetGanttChart";var i=document.createElement("article");i.className="gis-targetName",i.innerText=t.name+"：",e.appendChild(i);var s=document.createElement("div");return s.className="gis-taskSeries",s.id=t.code,e.appendChild(s),this.parentDiv.appendChild(e),e}},{key:"loadTargetStripe",value:function(t,e,i,s,n){var a=document.getElementById(t);if(a){n=("pink"===n?"red":"gray"===n&&"green")||n;var l=document.createElement("div");l.className="gis-bar "+n,l.title=e,l.setAttribute("start",Cesium.JulianDate.toDate(i).getTime()),l.setAttribute("stop",Cesium.JulianDate.toDate(s).getTime()),a.appendChild(l),this.stripe.push(l)}}},{key:"removeTargetTaskById",value:function(t){var e=document.getElementById(t);e&&(this.stripe.forEach(function(e,i){e.parentNode.parentNode.id===t&&this.stripe.splice(i,1)},this),this.parentDiv.removeChild(e),1===this.parentDiv.childNodes.length&&this.isRunning(!1))}},{key:"isRunning",value:function(t){Boolean(t)?(this.parentDiv.classList.add("active"),this.initEventListener()):(this.parentDiv.classList.remove("active"),this.removeEventListener())}}]),e}(o(i(185)).default);e.default=u}}]);